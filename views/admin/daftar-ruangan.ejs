<%- include("header.ejs")%>
<%- include("sidebar.ejs")%>
<div class="w-full lg:ps-64">
  <div class="p-4 sm:p-6 space-y-4 sm:space-y-6">
    <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
    </div>
    <div class="flex flex-col">
      <div class="-m-1.5 overflow-x-auto">
        <div class="p-1.5 min-w-full inline-block align-middle">
          <div class="bg-white  border-gray-200 rounded-xl shadow-sm overflow-hidden border dark:border-neutral-700 dark:shadow-neutral-700/70">
            <div class="px-6 py-4 grid gap-3 md:flex md:justify-between md:items-center border-b border-gray-200">
              <div>
                <h2 class="text-xl font-semibold text-gray-800">
                  Daftar Ruangan
                </h2>
                <p class="text-sm text-gray-600">
                  Tambah Ruangan, Edit dan Hapus Ruangan.
                </p>
              </div>
              <div>
                <div class="inline-flex gap-x-2">
                  <a class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-[#0a2e3b] text-white hover:bg-green-700 disabled:opacity-50 disabled:pointer-events-none" href="tambah-ruangan">
                    <svg class="flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
                    Tambah Ruangan
                  </a>
                </div>
              </div>
            </div>
            <div class="flex flex-col">
              <div class="-m-1.5 overflow-x-auto">
                <div class="p-1.5 min-w-full inline-block align-middle">
                  <div class="overflow-hidden">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-neutral-700">
                      <thead>
                        <tr>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">No</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Nama Ruangan</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Lokasi</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Kapasitas</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Fasilitas</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Foto</th>
                          <th scope="col" class="px-6 py-3 text-start text-xs font-medium text-red uppercase align-middle">Opsi</th>
                        </tr>
                      </thead>
                      <tbody class="divide-y divide-gray-200 dark:divide-neutral-700">
                        <% ruangans.forEach((item, index) => { %>
                          <tr>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-red align-middle"><%= index + 1 %></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-red align-middle"><%= item.namaRuangan %></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-red align-middle"><%= item.lokasi %></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-red align-middle"><%= item.kapasitas %></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-red align-middle"><%= item.fasilitas %></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-red align-middle"><img class="w-20 h-20 object-cover rounded" src="/uploads/ruangan/<%= item.foto %>" alt=""></td>
                            <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium flex space-x-2 align-middle">
                          <td class="px-6 py-4 whitespace-nowrap text-end text-sm font-medium flex space-x-2 align-middle">
                            <a href="/admin/detail-ruangan/<%= item.idRuangan %>" class="bg-[#1B6C89] py-2 px-2 inline-flex items-center gap-x-1 text-sm font-semibold rounded-lg border border-transparent text-white hover:text-green-300 ">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                              </svg>                              
                            </a>
                            <a href="/admin/edit-ruangan/<%= item.idRuangan %>" class="bg-yellow-400 py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent text-white hover:text-yellow-800 disabled:opacity-50 disabled:pointer-events-none ">
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/><path d="m15 5 4 4"/></svg>                       
                            </a>
                            <a data-hs-overlay="#hs-danger-alert-<%= item.idRuangan %>" class="bg-red-600 py-2 px-2 inline-flex items-center gap-x-1 text-sm font-semibold rounded-lg border border-transparent text-white hover:text-red-800">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                              </svg>                              
                            </a>
                          </td>
                        </tr>
                        <% }); %>
                      </tbody>
                    </table>
                  </div>      
                  <% ruangans.forEach(item => { %>       
                  <div id="hs-danger-alert-<%= item.idRuangan %>" class="hs-overlay hidden size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto">
                    <div class="hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all md:max-w-2xl md:w-full m-3 md:mx-auto">
                      <div class="relative flex flex-col bg-white border shadow-sm rounded-xl overflow-hidden">
                        <div class="absolute top-2 end-2">
                          <button type="button" class="flex justify-center items-center size-7 text-sm font-semibold rounded-lg border border-transparent text-gray-800 hover:bg-gray-100 disabled:opacity-50 disabled:pointer-events-none" data-hs-overlay="#hs-danger-alert-<%= item.idRuangan %>">
                            <span class="sr-only">Close</span>
                            <svg class="flex-shrink-0 size-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                          </button>
                        </div>
                  
                        <div class="p-4 sm:p-10 overflow-y-auto">
                          <div class="flex gap-x-4 md:gap-x-7">
                            <span class="flex-shrink-0 inline-flex justify-center items-center size-[46px] sm:w-[62px] sm:h-[62px] rounded-full border-4 border-red-50 bg-red-100 text-red-500">
                              <svg class="flex-shrink-0 size-5" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                              </svg>
                            </span>
                            <div class="grow">
                              <h3 class="mb-2 text-xl font-bold text-gray-800">
                                Delete <%= item.namaRuangan %> ?
                              </h3>
                              <p class="text-gray-500">
                                Menghapus ruangan secara permanen 
                              </p>
                            </div>
                          </div>
                        </div>
                        <div class="flex justify-end items-center gap-x-2 py-3 px-4 bg-gray-50 border-t">
                          <button type="button" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none" data-hs-overlay="#hs-danger-alert-<%= item.idRuangan %>">
                            Cancel
                          </button>
                          <form action="/admin/hapus-ruangan/<%= item.idRuangan %>" method="post" enctype="multipart/form-data"> 
                            <button type="submit" class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none">
                              Hapus Ruangan
                            </button>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                  <% }); %>
                </div>
              </div>
            </div>
            <div class="px-6 py-4 grid gap-3 md:flex md:justify-between md:items-center border-t border-gray-200">
              <div>
                <p class="text-sm text-gray-600">
                  <span class="font-semibold text-gray-800"><%= totalRuangan %></span> results
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const flash = <%= JSON.stringify(flash || {}) %>;
        if (flash.type && flash.message) {
            Swal.fire({
                icon: flash.type === 'error' ? 'error' : 'success',
                title: flash.type === 'error' ? 'Error' : 'Success',
                text: flash.message,
                timer: 3000,
            });
        }
    });
</script>
<%- include("./footer.ejs")%> 