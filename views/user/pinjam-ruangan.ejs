<%- include("head.ejs") %>
<div class="p-4 sm:p-6 space-y-4 sm:space-y-6">
  <div class="grid grid-cols-3 gap-4">
    <!-- Form Section (Left side) -->
    <div class="col-span-2">
      <div class="-m-1.5 overflow-x-auto">
        <div class="p-1.5 min-w-full inline-block align-middle">
          <div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
            <div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">
              <div class="mx-auto max-w-2xl">
                <div class="text-center">
                  <h2 class="text-xl text-gray-800 font-bold sm:text-3xl dark:text-black">
                    Peminjaman
                  </h2>
                </div>
                <div class="mt-5 p-4 z-10 bg-white border rounded-xl sm:mt-10 md:p-10 white:bg-neutral-900 dark:border-neutral-700">
                  <% if (message) { %>
                    <div class="mt-4 <%= message.type === 'error' ? 'bg-red-100 border-red-200 text-red-800' : 'bg-green-100 border-green-200 text-[#0a2e3b]' %> border text-sm rounded-lg p-4" role="alert">
                      <span class="font-bold"><%= message.type === 'error' ? '!' : '' %></span>
                      <%= message.text %>
                    </div>
                  <% } %>
                  <form method="post" action="/user/pinjam-ruangan/<%= ruangan ? ruangan.idRuangan : '' %>" enctype="multipart/form-data">
                    <div class="mb-4 sm:mb-8">
                      <label
                        for="namaRuangan"
                        class="block mb-2 text-sm font-medium dark:text-black"
                      >Nama Ruangan</label>
                      <input
                        type="text"
                        name="namaRuangan"
                        id="namaRuangan"
                        class="py-3 px-4 block w-full border border-black rounded-lg text-sm bg-gray-200 dark:bg-gray-700 dark:text-black"
                        value="<%= ruangan.namaRuangan%>"
                        disabled
                      />
                    </div>
    
                      <div class="mb-4 sm:mb-8">
                        <label
                          for="kegiatan"
                          class="block mb-2 text-sm font-medium dark:text-black"
                          >kegiatan Ruangan</label
                        >
                        <input
                          name="kegiatan"
                          type="text"
                          id="kegiatan"
                          class="py-3 px-4 block w-full border border-black rounded-lg text-sm focus:border-green-500 focus:ring-green-500 disabled:opacity-50 disabled:pointer-events-none bg-white:bg-neutral-900 dark:border-neutral-700 dark:text-black dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                          placeholder="Tambah kegiatan"
                        />
                      </div>
    
                      <div class="mb-4 sm:mb-8">
                        <label
                          for="tanggal"
                          class="block mb-2 text-sm font-medium dark:text-black"
                          >tanggal Mulai</label
                        >
                        <input
                          name="tanggalMulai"
                          type="date"
                          id="tanggalMulai"
                          class="py-3 px-4 block w-full border border-black rounded-lg text-sm focus:border-green-500 focus:ring-green-500 disabled:opacity-50 disabled:pointer-events-none bg-white:bg-neutral-900 dark:border-neutral-700 dark:text-black dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                          placeholder="Tambah tanggal"
                        />
                      </div>
    
                      
                      <div class="mb-4 sm:mb-8">
                      <label
                        for="tanggal"
                        class="block mb-2 text-sm font-medium dark:text-black"
                        >tanggal Selesai</label
                      >
                      <input
                        name="tanggalSelesai"
                        type="date"
                        id="tanggalSelesai"
                        class="py-3 px-4 block w-full border border-black rounded-lg text-sm focus:border-green-500 focus:ring-green-500 disabled:opacity-50 disabled:pointer-events-none bg-white:bg-neutral-900 dark:border-neutral-700 dark:text-black dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                        placeholder="Tambah tanggal"
                      />
                    </div>
    
                      <div class="mb-4 sm:mb-8">
                        <label
                          for="waktuMulai"
                          class="block mb-2 text-sm font-medium dark:text-black"
                          >Waktu Mulai</label
                        >
                        <input
                          name="waktuMulai"
                          type="time"
                          id="waktuMulai"
                          class="py-3 px-4 block w-full border border-black rounded-lg text-sm focus:border-green-500 focus:ring-green-500 disabled:opacity-50 disabled:pointer-events-none bg-white:bg-neutral-900 dark:border-neutral-700 dark:text-black dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                          placeholder="Tambah waktuMulai"
                        />
                      </div>
    
                      <div class="mb-4 sm:mb-8">
                        <label
                          for="waktuSelesai"
                          class="block mb-2 text-sm font-medium dark:text-black"
                          >waktu Selesai</label
                        >
                        <input
                          name="waktuSelesai"
                          type="time"
                          id="waktuSelesai"
                          class="py-3 px-4 block w-full border border-black rounded-lg text-sm focus:border-green-500 focus:ring-green-500 disabled:opacity-50 disabled:pointer-events-none bg-white:bg-neutral-900 dark:border-neutral-700 dark:text-black dark:placeholder-neutral-500 dark:focus:ring-neutral-600"
                          placeholder="Tambah waktuSelesai"
                        />
                      </div>
    
                      <div class="mb-4">
                        <label
                          for="file"
                          class="block mb-2 text-sm font-medium dark:text-black"
                          >Surat Permohonan Peminjaman
                          <a href="/user/template-surat">Download Here</a></label
                        >
                        <input
                          type="file"
                          name="formulir"
                          id="file"
                          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        />
                      </div>
                      <img
                        id="imagePreview"
                        src="#"
                        alt="Image Preview"
                        style="display: none; max-width: 200px; max-height: 200px"
                      />
                      <div class="mt-6 grid gap-4 grid-cols-2">
                        <button
                          type="submit"
                          value="submit"
                          class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-[#0a2e3b] text-white hover:bg-green-700 disabled:opacity-50 disabled:pointer-events-none"
                        >
                          Simpan
                        </button>
                        <a
                          href="/user/daftar-ruangan"
                          class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-[#0a2e3b] text-white hover:bg-green-700 disabled:opacity-50 disabled:pointer-events-none"
                          >Batal</a
                        >
                      </div>
                    </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- List Section (Right side) -->
    <div>
    <div class="bg-white p-4 border border-gray-200 rounded-xl shadow-sm overflow-hidden">
      <div class="text-center">
        <h3 class="text-lg font-semibold text-gray-800">Daftar Peminjaman: <%= ruangan.namaRuangan %>

        </h3>



      </div>
      <div class="mt-4">
        <% if (peminjamanList && peminjamanList.length > 0) { %>
          <ul class="space-y-4">
            <% peminjamanList.forEach(function(peminjaman) { %>
              <li class="flex justify-between items-center p-4 bg-gray-100 rounded-lg">
                <div>
                  <p class="text-sm font-medium text-gray-700">Kegiatan: <%= peminjaman.kegiatan %></p>
                  <p class="text-sm text-gray-500">Tanggal: <%= peminjaman.tanggalMulai %> - <%= peminjaman.tanggalSelesai %></p>
                  <p class="text-sm text-gray-500">Jam: <%= peminjaman.jamMulai %> - <%= peminjaman.jamSelesai %></p>

                </div>
              </li>
            <% }); %>
          </ul>
        <% } else { %>
          <p class="text-gray-500">Belum ada peminjaman untuk ruangan ini.</p>
        <% } %>
      </div>
    </div>
  </div>

  </div>
</div>

<script>
  document.getElementById("file").addEventListener("change", function (event) {
    var reader = new FileReader();
    reader.onload = function (e) {
      document.getElementById("imagePreview").src = e.target.result;
      document.getElementById("imagePreview").style.display = "block";
    };
    reader.readAsDataURL(event.target.files[0]);
  });
</script>

<%- include("footer.ejs") %>
